# Calculating Column Statistics

# Once more, we’ll revisit our orders from ShoeFly.com. Our new batch of orders is in the DataFrame orders. Examine the first 10 rows.
orders = pd.read_csv('orders.csv')
print(orders.head(10))


# Our finance department wants to know the price of the most expensive pair of shoes purchased. Save your answer to the variable most_expensive.
most_expensive = orders.price.max()


# Our fashion department wants to know how many different colors of shoes we are selling. Save your answer to the variable num_colors.
num_colors = orders.shoe_color.nunique()


# Let’s return to our orders data from ShoeFly.com.
# In the previous exercise, our finance department wanted to know the most expensive shoe that we sold.
# Now, they want to know the most expensive shoe for each shoe_type (i.e., the most expensive boot, the most expensive ballet flat, etc.).
# Save your answer to the variable pricey_shoes.
# Examine the object that you just created.

pricey_shoes = orders.groupby('shoe_type').price.max()
print(pricey_shoes)

	            price
ballet flats	 498
sandals	       498
stilettos	     468
wedges	       488

# Modify your code from the previous exercise so that it ends with reset_index, which will change pricey_shoes into a DataFrame.
# Examine the object that you’ve just created using

pricey_shoes = orders.groupby('shoe_type').price.max().reset_index()

print(pricey_shoes)

	  shoe_type	    price
0	 ballet flats	   498
1	   sandals	     498
2	  stilettos	     468
3	   wedges	       488


# Let’s calculate the 25th percentile for shoe price for each shoe_color to help Marketing decide if we have enough cheap shoes on sale. 
# Save the data to the variable cheap_shoes.
# Note: Be sure to use reset_index() at the end of your query so that cheap_shoes is a DataFrame.
# Display cheap_shoes using print.

import codecademylib3
import numpy as np
import pandas as pd

orders = pd.read_csv('orders.csv')

cheap_shoes = orders.groupby('shoe_color').price.apply(lambda x: np.percentile(x, 25)).reset_index()
print(cheap_shoes)
